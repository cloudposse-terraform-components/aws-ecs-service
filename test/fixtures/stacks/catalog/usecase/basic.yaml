components:
  terraform:
    ecs-service/echo-server:
      metadata:
        component: ecs-service
      vars:
        enabled: true
        name: echo-server
        ecs_cluster_name: ecs/cluster

        domain_name: example.net
        autoscaling_enabled: false
        use_lb: true
        stickiness_enabled: false
        alb_configuration: "public"

        ecr_stage_name: core-artifacts
        ecr_region: us-east-1

        containers:
          service:
            name: "echoserver"
            image: gcr.io/google_containers/echoserver:1.10
            port_mappings:
              - containerPort: 8080
                hostPort: 8080
                protocol: tcp
            log_configuration:
              logDriver: awslogs
              options: {}

        task:
          launch_type: FARGATE
          deployment_controller_type: ECS
          network_mode: awsvpc
          desired_count: 1
          task_memory: 512
          task_cpu: 256
          ignore_changes_desired_count: true
          ignore_changes_task_definition: false
          assign_public_ip: false
          propagate_tags: SERVICE
          wait_for_steady_state: true
          circuit_breaker_deployment_enabled: true
          circuit_breaker_rollback_enabled: true
          capacity_provider_strategies:
            - capacity_provider: FARGATE_SPOT
              weight: 1
              base: 0
